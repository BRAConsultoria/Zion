<?include_once($_SESSION['FMBase'].'acesso.bd.php');class BotoesAcesso extends AcessoBD{    private $BotaoImprimir;    public function BotoesAcesso()    {        $this->BotaoImprimir = true;        parent::AcessoBD();    }    public function geraBotoes($ArrayExclusao = array(), $ArrayInclusao = array())    {        $ArrayBotoes = array();        $Posicoes    = array();        $Botoes      = "";                if(!defined('MODULO')) throw new Exception("O módulo não foi definido!");        if(!is_array($ArrayExclusao)) throw new Exception("O parametro de exclusão deve ser um array!");        try        {            $RSAcesso = parent::acessoBotoes(MODULO, $_SESSION['UsuarioCod']);        }        catch (Exception $E)        {            throw new Exception($E->getMessage());        }        $Html = '<div class="divBotoes">';        $Cont = 0;        while ($Dados = @mysqli_fetch_array($RSAcesso))        {            $Cont++;                        $Botoes = "";            if(!in_array($Dados['IdPermissao'],$ArrayExclusao))            {                $Cont++;                if($Dados['Permissao'] == "S" and $_GET['Op'] != $Dados['IdPermissao'])                {                    $Botoes  = '<span class="btMenu"><a href="javascript:'.$Dados['Funcao'].'">';                    $Botoes .= '<img src="'.$_SESSION['UrlBase'].'figuras/'.$Dados['ImagemOn'].'" alt="'.$Dados['AltP'].'" border="0"/>';                    $Botoes .= '</a></span>';                }                else                {                    $AltNP = ($_GET['Op'] == $Dados['IdPermissao']) ? "Módulo Atual" : $Dados['AltNP'];                    $Botoes  = '<span class="btMenu">';                    $Botoes .= '<img src="'.$_SESSION['UrlBase'].'figuras/'.$Dados['ImagemOff'].'" alt="'.$AltNP.'"/>';                    $Botoes .= '</span>';                }                $ArrayBotoes[$Cont] = $Botoes;                $Posicoes[$Cont]    = $Dados['Posicao'];            }        }        //Incluir Botões        if(is_array($ArrayInclusao))        {            foreach($ArrayInclusao as $DadosBotao)            {                $Cont++;                $Botoes  = '<span class="btMenu"><a href="javascript:'.$DadosBotao['Funcao'].'">';                $Botoes .= '<img src="'.$_SESSION['UrlBase'].'figuras/'.$DadosBotao['Imagem'].'" alt="'.$DadosBotao['Alt'].'" border="0"/>';                $Botoes .= '</a></span>';                $ArrayBotoes[$Cont] = $Botoes;                $Posicoes[$Cont]    = (int) $DadosBotao['Posicao'];            }        }        if($this->BotaoImprimir == true or in_array('Print',$ArrayExclusao))        {            $Cont++;            $Botoes  = '<span class="btMenu" id="sis_print_mascara" onclick="sis_imprimir(\''.MODULO.'\')">';            $Botoes .= '<img src="'.$_SESSION['UrlBase'].'figuras/bt_imprimir.gif" alt="Imprimir"/>';            $Botoes .= '</span><span id="sis_print">&nbsp;</span>';            $Botoes .= '<iframe width="0" height="0" frameborder="0" scrolling="no" allowtransparency="1"  id="sis_iframe_print" name="sis_iframe_print"></iframe>';            $ArrayBotoes[$Cont] = $Botoes;            $Posicoes[$Cont]    = 99; //Imprimir Sempre Ultima Posição        }        //Gerando HTML com as Posições Corretas        asort($Posicoes,SORT_NUMERIC);                foreach ($Posicoes as $Chave => $Posicao)        {            $Html .= $ArrayBotoes[$Chave];        }        $Html .= '</div>';        //Corpo dos Botões        $Corpo = '<table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#E7EFF7"><tr><td align="left">'.$Html.'</td><td align="center"><div id="sucesso"></div></td><td align="center">';                $Corpo .= '</td></tr></table>';        return $Corpo;    }    public function setBotaoImprimir($Valor)    {        $this->BotaoImprimir = $Valor;    }}